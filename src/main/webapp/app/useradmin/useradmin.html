

<!-- Users tool bar -->
  	<div class="row toolbar" ng-show="userTabOpen" >
     		<h3>
  	        <span class="glyphicon glyphicon-cog"></span>
		  Users and Labs
	   </h3>

 
   		<a ng-click="openNewUserWindow()"  href="#/useradmin">
  				<span class="glyphicon glyphicon-plus"></span>Add User
		</a>
      

		<a ng-click="confirmUserDelete()"  href="#/useradmin">
 		 	<span class="glyphicon glyphicon-minus"></span>Delete User
		</a>
		
		<label for="labSelect">Lab </label>
		<select id="labSelect" ng-model="selectedLab"  ng-options="lab.last for lab in labs" >
			<option value=""></option>
		</select>
			
		<label class="label label-warning">{{message}}</label>
			
	    <div class="form-group right">
	  		 <label for="search">Filter Users </label>	
			 <input id="search" ng-model="userQuery">
	    </div>
</div>


<!-- Lab tool bar -->
<div class="row toolbar" ng-show="labTabOpen" >
     	<h3>
     		<span class="glyphicon glyphicon-cog"></span>
     		Users and Labs
     	</h3>
     		
		<a ng-click="openNewLabWindow()" href="#/useradmin">
 		 	<span class="glyphicon glyphicon-plus"></span>Add Lab
		</a>
		
		<a ng-click="confirmLabDelete()" href="#/useradmin">
 		 	<span class="glyphicon glyphicon-minus"></span>Delete lab
		</a>
		
		<label class="label label-warning">{{message}}</label>
			
		<div class="form-group right">
			<label for="search">Filter Labs </label>	
			<input id="search" ng-model="labQuery">
	    </div>
</div>

<!-- Admin tool bar -->
<div class="row toolbar" ng-show="genomeTabOpen" >
     	<h3>
     		<span class="glyphicon glyphicon-cog"></span>
     		Users and Labs
     	</h3>
     		
		<a ng-click="openNewOrganismWindow()" href="#/useradmin">
 		 	<span class="glyphicon glyphicon-plus"></span>Add Organism
		</a>
		
		<a ng-click="openNewBuildWindow()" href="#/useradmin">
 		 	<span class="glyphicon glyphicon-plus"></span>Add Organism Build
		</a>
		
		<a ng-click="confirmOrganismDelete()" href="#/useradmin">
 		 	<span class="glyphicon glyphicon-minus"></span>Delete Organism Build
		</a>
		
		<label class="label label-warning">{{message}}</label>
</div>



<div class="row">	
	<div class="panel panel-default col-lg-12">
	  <div class="panel-body" style="padding-top: 10px;">	
	    <tabset>
	     	<tab heading="Users" active="$parent.userTabOpen" >
	     		<div>
			     	<table class="table" id="userTable" >
			     	    <thead>
					      <tr>
					        <th ng-click="selectAllUsersChanged()">Selected</th>
					        <th ng-click="userOrderByField='first'; userReverseSort=!userReverseSort">First Name</th>
					        <th ng-click="userOrderByField='last'; userReverseSort=!userReverseSort">Last Name</th>
					        <th ng-click="userOrderByField='username'; userReverseSort=!userReverseSort">Username</th>
					        <th ng-click="userOrderByField='email'; userReverseSort=!userReverseSort">Email Address</th>
					        <th>Admin</th>
					        <th ng-click="userOrderByField='phone'; userReverseSort=!userReverseSort">Phone Number</th>
					        <th>Labs</th>
					        <th>Institutions</th>
					      </tr>
					    </thead>
					    <tbody>
				         	<tr data-ng-repeat="user in selectedUsers | filter:userQuery | orderBy:userOrderByField:userReverseSort | startFrom:userCurrentPage*userLimit | limitTo:userLimit " ng-dblclick="openEditUserWindow(user)">
				         	    <td><input ng-model=user.selected type="checkbox"/></td>
				             	<td>{{user.first}}</td>
				             	<td>{{user.last}}</td>
				             	<td>{{user.username}}</td>
				             	<td>{{user.email}}</td>
				             	<td><span class="glyphicon glyphicon-wrench" ng-show="user.admin"></span></td>
				             	<td>{{user.phone | displayPhone}}</td> 
				             	<td><span ng-repeat="l in user.labs">{{l.last}}{{$last ? ' Lab' : ', '}}</span></td>
				             	<td><span ng-repeat="i in user.institutes">{{i.name}}{{$last ? '' : ', '}}</span></td>
				             	<td ng-show="false">{{user.idUser}}</td>
				         	</tr>
			         	</tbody>
			    	</table>
		    	</div>
		    	<div class="row show-grid">
		    			<button ng-disabled="userCurrentPage == 0" ng-click="userCurrentPage=userCurrentPage-1" class="btn btn-mini col-lg-1"><span class="glyphicon glyphicon-chevron-left"></span> </button>
		    			<div class="center col-lg-10">
		    			    <div class="row">
			    			    <select ng-model="userLimit" class="center">
			 		     	    	<option value=5>Show 5</option>
			 		     	    	<option value=10>Show 10</option>
			 		     	    	<option value=25>Show 25</option>
			 		     	    	<option value=50>Show 50</option>
		 		     	    	</select>
		    			    </div>
		    			    <div class="row">
		    			    	<small class="center">{{userCurrentPage+1}}/{{ selectedUsers.length / userLimit | ceil}} </small>
		    			    </div>
		    			</div>
		    			
			    		<button ng-disabled="userCurrentPage >= selectedUsers.length/userLimit - 1" ng-click="userCurrentPage=userCurrentPage+1" class="btn btn-mini col-lg-1">
			    			<span class="glyphicon glyphicon-chevron-right"></span>
			    		</button>
	     	   	</div>
	     	</tab>
	     	<tab heading="Labs" active="$parent.labTabOpen">
	     	    <div>
	     		<table class="table">
	     			<thead>
					      <tr>
					        <th>Selected</th>
					        <th ng-click="labOrderByField='first'; labReverseSort=!labReverseSort">First Name</th>
					        <th ng-click="labOrderByField='last'; labReverseSort=!labReverseSort">Last Name</th>
					        <th ng-click="labOrderByField='count'; labReverseSort=!labReverseSort">Member Count</th>
					      </tr>
				    </thead>
				    <tbody>				         	
				    	<tr data-ng-repeat="lab in labs | filter:labQuery | orderBy:labOrderByField:labReverseSort | startFrom:labCurrentPage*labLimit | limitTo:labLimit" ng-dblclick="openEditLabWindow(lab)">
				    	    <td><input ng-model=lab.selected type="checkbox" ng-disabled="lab.count != 0"/></td>
			             	<td>{{lab.first}}</td>
			             	<td>{{lab.last}}</td>
			             	<td>{{lab.count}}</td>
		         		</tr>
				    </tbody>
		    	</table>
		    	</div>
		    	<div class="row show-grid">
		    			<button ng-disabled="labCurrentPage == 0" ng-click="labCurrentPage=labCurrentPage-1" class="btn btn-mini col-lg-1"><span class="glyphicon glyphicon-chevron-left"></span> </button>
		    			<div class="center col-lg-10">
		    			    <div class="row">
			    			    <select ng-model="labLimit" class="center">
			 		     	    	<option value=5>Show 5</option>
			 		     	    	<option value=10>Show 10</option>
			 		     	    	<option value=25>Show 25</option>
			 		     	    	<option value=50>Show 50</option>
		 		     	    	</select>
		    			    </div>
		    			    <div class="row">
		    			    	<small class="center">{{labCurrentPage+1}}/{{ (labs.length / labLimit) | ceil }}</small>
		    			    </div>
		    			</div>
			    		<button ng-disabled="labCurrentPage >= labs.length/labLimit - 1" ng-click="labCurrentPage=labCurrentPage+1" class="btn btn-mini col-lg-1">
			    			<span class="glyphicon glyphicon-chevron-right"></span>
			    		</button>
	     	   	</div>
	     	</tab>
	     	<tab heading="Organisms" active="$parent.genomeTabOpen">
	     	   <div>
		     	<table class="table " >
				    <thead>
				        <tr>
				            <th>Selected</th>
				            <th>Organism</th>
				            <th>Build Name</th>
				            <th>Transcript File</th>
				            <th></th>
				            <th>Genome File</th>
				            <th></th>
				            <th>Gene Alias File</th>
				            <th></th>
				            <th></th>
				        </tr>
				    </thead>
				    <tbody>
				        <tr ng-repeat="ob in organismBuildList" ng-mouseenter="hideOrganismControls(ob)" ng-mouseleave="hideOrganismControls(ob)" >
				        	<td style="width: 10% "><input ng-model=ob.selected type="checkbox"/></td>	
				        	<td style="width: 12%;" ng-dblclick="openEditOrganismWindow(ob.organism.idOrganism)">{{ob.organism.idOrganism | lookupOrganism:organismList}}</td>
				            <td style="width: 12%;" ng-dblclick="openEditBuildWindow(ob)">
				            	{{ob.name}}
				            	<span class="glyphicon glyphicon-star" ng-show="(ob.transcriptFile != null && ob.genomeFile != null && ob.geneIdFile != null)"></span>
				            	<span class="glyphicon glyphicon-star-empty" ng-show="(ob.transcriptFile != null && ob.genomeFile != null && ob.geneIdFile == null)"></span>
				            </td>
				            <td style="width: 12%;">{{ob.transcriptFile}}</td>
				            <td style="width: 10%;" >
				                <div ng-show="ob.show">
					                <span class="btn btn-xs btn-primary fileinput-button" ng-show="ob.transcriptFile == null">
								        <i class="glyphicon glyphicon-plus"></i>
								        <input type="file" ng-file-select="addTranscriptFile($files, ob)"> 
							        </span>
							        <span class="btn btn-xs btn-warning fileinput-button" ng-show="ob.transcriptFile != null">
								        <i class="glyphicon glyphicon-repeat"></i>
								        <input type="file" ng-file-select="addTranscriptFile($files, ob)"> 
							        </span>
					                <button class="btn btn-xs btn-danger" ng-click="confirmOrganismFileDelete(ob,'transcripts')" ng-show="ob.transcriptFile != null">
					                 	<span class="glyphicon glyphicon-minus"></span>
					                </button>
				                
				                </div>
					            
				            </td>
				            <td style="width: 12%;">{{ob.genomeFile}}</td>
				            <td style="width: 10%;" >
				                <div ng-show="ob.show">
					                <span class="btn btn-xs btn-primary fileinput-button" ng-show="ob.genomeFile == null">
								        <i class="glyphicon glyphicon-plus"></i>
								        <input type="file" ng-file-select="addGenomeFile($files, ob)"> 
							        </span>
							        <span class="btn btn-xs btn-warning fileinput-button" ng-show="ob.genomeFile != null">
								        <i class="glyphicon glyphicon-repeat"></i>
								        <input type="file" ng-file-select="addGenomeFile($files, ob)"> 
							        </span>
					                <button class="btn btn-xs btn-danger" ng-click="confirmOrganismFileDelete(ob,'genome')" ng-show="ob.genomeFile != null">
					                 	<span class="glyphicon glyphicon-minus"></span>
					                </button>
				                
				                </div>
				            	
				            </td>
				            <td style="width: 12%;">{{ob.geneIdFile}}</td>
				            <td style="width: 10%;">
				                <div ng-show="ob.show">
					                <span class="btn btn-xs btn-primary fileinput-button" ng-show="ob.geneIdFile == null">
							        	<i class="glyphicon glyphicon-plus"></i>
							        	<input type="file" ng-file-select="addAnnotationFile($files, ob)"> 
							        </span>
							        <span class="btn btn-xs btn-warning fileinput-button" ng-show="ob.geneIdFile != null">
								        <i class="glyphicon glyphicon-repeat"></i>
								        <input type="file" ng-file-select="addAnnotationFile($files, ob)"> 
							        </span>
					                <button class="btn btn-xs btn-danger" ng-click="confirmOrganismFileDelete(ob,'annotations')" ng-show="ob.geneIdFile != null">
					                 	<span class="glyphicon glyphicon-minus"></span>
					                </button>

				                </div>
				            	
				            </td>   
				        </tr>
				    </tbody>
				</table>
			   </div>
	     	</tab>
	    </tabset>
		</div>
	</div>
</div>



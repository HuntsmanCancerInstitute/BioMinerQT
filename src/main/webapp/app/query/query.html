

<form name="queryForm" class="form-horizontal" >
<fieldset>

	<!--                 -->
    <!--  Toolbar        -->
 	<!--                 -->
   	<div class="row" style="padding-top:12px" >
  	       <h3 class="pull-left h3-toolbar"">
   	       		<span class="glyphicon glyphicon-zoom-in"></span> Query
		   </h3>
	</div>
	

	 			
	<!--                 -->
    <!--  Main panel     -->
 	<!--                 -->
	<div class="row">
	
	
     	<!--                         -->
        <!--  Query (sidebar) Panel  -->
     	<!--                         -->
     	<div class="col-sm-12 col-md-12 col-lg-4">  
 

     	
            <div class="panel panel-default">
				<div class="panel-heading">
				    Compose Query 				   			
					<button class="btn btn-sm btn-default pull-right" style="margin-top: -6px;margin-left: 10px" ng-click="clearQuery()">
	  						<span class="glyphicon glyphicon-remove"></span> Clear
		   			</button>
					<button class="btn btn-sm btn-warning pull-right" style="margin-top: -6px"  ng-disabled="queryForm.$invalid" ng-click="runQuery()">
	  						<span class="glyphicon glyphicon-play"></span> Run Query
		   			</button>
				</div>
	  	   
				
           	 	<div class="panel-body">
            	 	
           	 		<span class="section-header" style="padding-top: 0px">What would you like to find?</span>
           	 			
           	 		<!-- What type of result do you want back? -->
           	 		<div class="form-group" style="padding-top: 0px">
					  <div class="col-md-12"> 
					    <label ng-repeat="(key,name) in mapResultType" class="radio-inline" for="radio-rt-{{ key }}">
					      <input name="result-type"
					      		 id="radio-rt-{{ key }}"
					      		 required
					      	     ng-model="$parent.codeResultType" 
					      	     ng-value="key" 
					      	     ng-change="pickResultType()"
					      	     type="radio">{{ name }}
					    </label> 
					  </div>
					</div>

  
           	 		<span class="section-header" >What Genome?</span>
					<div class="form-group" >
		  				<div class="col-md-12">
		    				<select name="gb-select"
		    				        ng-model="idOrganismBuild" 
		    				        required
		    				        ng-options="gb.idOrganismBuild as gb.name group by gb.organism.common for gb in organismBuildList" 
		    				        class="form-control">
		    				        <option value="">Select genome build</option>
		    				</select>
		  				</div>
					</div>
					
  
           	 		<span class="section-header" >What Datasets?</span>
           	 		
           	 		<!-- What data sets? -->
					<div class="form-group">
					  <div class="col-md-12">
					    <label ng-repeat="analysisType in analysisTypeCheckedList" 
					           ng-class="analysisType.class" 
					           ng-disabled="!analysisType.show || !analysisType.possible" 
					           class="checkbox-inline" 
					           for="checkbox-at-{{ analysisType.idAnalysisType }}">
					      <input name="checkbox-at-{{ analysisType.idAnalysisType }}" 
					             ng-required="!someAnalysisTypeChecked()" 
					             ng-disabled="!analysisType.show || !analysisType.possible"  
					             id="checkbox-at-{{ analysisType.idAnalysisType }}" 
					             ng-model="analysisType.selected" type="checkbox" >
					     {{ analysisType.type }}
					    </label>
					  </div>
					</div>
					
					
					<!--  Lab -->
					<div class="form-group">
						<label class="col-md-4 control-label" for=""labEntry">Labs</label>  
					    <select data-placeholder="Choose labs..." multiple class="col-md-7 chosen-select" ng-model="selectedLabs" chosen ng-options="lab as (lab.first + ' ' + lab.last + ' lab' ) for lab in labList track by lab.idLab"  ></select>
					</div>
					
					<!--  Analysis Project -->
					<div class="form-group">
						<label class="col-md-4 control-label" for=""labEntry">Analysis Projects</label>  
					    <select data-placeholder="Choose analysis projects..." multiple class="col-md-7 chosen-select" ng-model="selectedProjects" chosen="projectList" ng-options="project as project.name for project in projectList track by project.idProject"  ></select>
					</div>
					
					<!--  Analysis  -->
					<div class="form-group">
						<label class="col-md-4 control-label" for=""labEntry">Individual Analysis</label>  
					    <select data-placeholder="Choose individual analysis..." multiple class="col-md-7 chosen-select" ng-model="selectedAnalyses" chosen="analysisList" ng-options="a as a.name for a in analysisList track by a.idAnalysis"  ></select>
					</div>
					
					<!--  Sample Source  -->
					<div class="form-group">
						<label class="col-md-4 control-label" for=""labEntry">Sample Source</label>  
					    <select data-placeholder="Choose sample source..." multiple class="col-md-7 chosen-select" ng-model="selectedSampleSources" chosen  ng-options="sampleSource as sampleSource.source for sampleSource in sampleSourceList track by sampleSource.idSampleSource"  ></select>
					</div>



          	 		
					
          	 		<!-- Interest or Don't Intersect -->
           	 		<span class="section-header" >That</span>
          	 		
          	 		<div class="form-group">
					  <div class="col-md-12"> 
						<div class="btn-group">
   					     	<label class="btn btn-toggle" ng-model="isIntersect" btn-radio="'true'" >Intersect</label>
        					<label class="btn btn-toggle" ng-model="isIntersect" btn-radio="'false'">Don't Intersect</label>
    					</div>
    					<span class="btn btn-primary pull-right fileinput-button" ng-show="isIntersect == 'true' && !isGeneBasedQuery && intersectionTarget == 'REGION'">
					        <i class="glyphicon glyphicon-upload"></i>
					        <span>Import Regions</span>
					        <input type="file" ng-file-select="loadRegions($files)">            
					    </span>
					    
					
					  </div>
					</div>
					
					
          	 		<!-- Regions-->
					<div class="form-group"  ng-show="isIntersect == 'true'">
					    <div class="col-md-3" style="padding-right: 0px;">
					      <div class="radio">
						   		<label for="radio-region">
							    	<input name="radios-region-gene" id="radio-region" ng-model="intersectionTarget" value="REGION" type="radio"> Regions
						   		</label>
						  </div>
					    </div>
					    <div class="col-md-9"  ng-show="intersectionTarget == 'REGION'" style="padding-left: 1px; padding-right: 0px;">
				    		<textarea ng-model="regions" style="display: inline; width: 60%" class="form-control" placeholder="chr1:4500-8900"/>
					    	&nbsp;&nbsp;+/-
					    	<input type="text" ng-model="regionMargins" style="display: inline; max-width: 60px;" class="form-control" placeholder="1000"/> 
					    	bp
				    	</div>
					    
					</div>
							 
          	 		<!-- Genes-->
					<div class="form-group" ng-show="isGeneBasedQuery">
						<div class="col-md-3" style="padding-right: 0px;">
					      <div class="radio">
						   		<label for="radio-gene">
							    	<input name="radios-region-gene" id="radio-gene"  ng-model="intersectionTarget" value="GENE" type="radio"> Genes
						   		</label>
						  </div>
						</div>
					 	<div class="col-md-9" ng-show="intersectionTarget == 'GENE'" style="padding-left: 1px; padding-right: 0px;">
				    		<input type="text" ng-model="genes" style="display: inline; width: 60%" class="form-control" placeholder="gene, gene, ...">
					    	&nbsp;&nbsp;+/-
					    	<input type="text" ng-model="geneMargins" style="display: inline; max-width: 60px;"class="form-control" placeholder="1000"/> 
					    	bp
				    	</div>
					</div>

         	 		<!-- Genes annotations-->
					<div class="form-group" ng-show="isGeneBasedQuery">
					 	<div class="col-md-3" style="padding-right: 0px;">
					    </div>
					    <div class="col-md-9" ng-show="intersectionTarget == 'GENE'" style="padding-left: 1px; padding-right: 0px;">
						    <select data-placeholder="Choose gene annotations..."   multiple class="col-md-12 chosen-select" ng-model="selectedGeneAnnotations" chosen ng-options="geneAnnotation.name for geneAnnotation in geneAnnotationList"  ></select>
					    </div>
					</div>
					
					
					<!--  Thresholds -->
           	 		<span class="section-header" ng-show="isThresholdBasedQuery">That Exceed these Thresholds</span>
           	 		 
           	 		 <!-- FDR-->
					<div class="form-group" ng-show="isThresholdBasedQuery">
					  <label class="col-md-3 control-label" >FDR</label>  
				  	  <div class="col-md-5 btn-group ">
				  	  		<label class="btn btn-toggle" ng-model="codeThresholdFDRComparison" btn-radio="'GT'" >&gt;</label>
				  	  		<label class="btn btn-toggle" ng-model="codeThresholdFDRComparison" btn-radio="'LT'" >&lt;</label>
  					     	
   					  </div>
					  <input id="textinput" class="col-md-4 form-control" style="display: inline; max-width: 180px" ng-model="thresholdFDR" name="textinput" placeholder=".05"  type="number" step="any">
					</div>        
					
           	 		
           	 		 <!-- Log2 Ratio-->
					<div class="form-group" ng-show="isThresholdBasedQuery">
					    <label class="col-md-3 control-label">Log2Ratio</label>  
					  	<div class="col-md-5 btn-group">
   					     	<label class="btn btn-toggle" ng-model="codeThresholdLog2RatioComparison" btn-radio="'GTABS'" >&gt; abs</label>
   					     	<label class="btn btn-toggle" ng-model="codeThresholdLog2RatioComparison" btn-radio="'GT'"     >&gt;</label>
        					<label class="btn btn-toggle" ng-model="codeThresholdLog2RatioComparison" btn-radio="'LT'"     >&lt;</label>
    					</div>
					    
						<input id="textinput" class="col-md-4 form-control"   style="display: inline; max-width: 180px" ng-model="thresholdLog2Ratio" name="textinput" placeholder="1.0"  type="number", step="any">
					</div>        

					
					
					<!--  Variant Criteria -->
           	 		<span class="section-header" ng-hide="isThresholdBasedQuery"  >That Meet Variant Criteria</span>

					<!-- Variant qual filter -->
					<div class="form-group" ng-hide="isThresholdBasedQuery">
					  <label class="col-md-3 control-label" for="variant-filter-radios">Qual</label>
					  <div class="col-md-6">
					  	<div class="btn-group">
   					     	<label class="btn btn-toggle" ng-model="codeThresholdVariantQualComparison" btn-radio="'>'" >&gt;</label>
        					<label class="btn btn-toggle" ng-model="codeThresholdVariantQualComparison" btn-radio="'<'" >&lt;</label>
    					</div>
						<input id="textinput" class="form-control col-md-3" ng-model="thresholdVariantQual" name="textinput" placeholder="20" type="text">
					  </div>
					</div>

					
					<!-- Variant pass/nopass filter -->
					<div class="form-group" ng-hide="isThresholdBasedQuery">
					  <label class="col-md-3 control-label" for="variant-filter-radios">Filter</label>
					  <div class="col-md-6"> 
					    <label class="radio-inline" for="variant-filter-radios-0">
					      <input name="variant-filter-radios" id="variant-filter-radios-0" ng-model="codeVariantFilterPass" value="PASS" checked="checked" type="radio">
					      PASS
					    </label> 
					    <label class="radio-inline" for="variant-filter-radios-1">
					      <input name="variant-filter-radios" id="variant-filter-radios-1" ng-model="codeVariantFilterPass"  value="NOPASS" type="radio">
					      Not PASS
					    </label>
					  </div>
					</div>
					
					<!-- Variant type -->
					<div class="form-group" ng-hide="isThresholdBasedQuery">
					  <label class="col-md-3 control-label" for="variant-type-radios">Type</label>
					  <div class="col-md-6"> 
					    <label class="radio-inline" for="variant-type-radios-0">
					      <input name="variant-type-radios" id="variant-type-radios-0" ng-model="codeVariantFilterType" value="SNV" checked="checked" type="radio">
					      SNV
					    </label> 
					    <label class="radio-inline" for="variant-type-radios-1">
					      <input name="variant-type-radios" id="variant-type-radios-1"  ng-model="codeVariantFilterType" value="INDEL" type="radio">
					      INDEL
					    </label>
					  </div>
					</div>
					
        	 		<!-- Variant Genotype-->
					<div class="form-group" ng-hide="isThresholdBasedQuery">
					 	<label class="col-md-3 control-label" for="genotypes">Genotype</label>
					    <div class="col-md-9">
						    <select name="genotypes" data-placeholder="Choose genotypes..."   multiple class="col-md-12 chosen-select" ng-model="selectedGenotypes" chosen ng-options="genotype.name for genotype in genotypeList"  ></select>
					    </div>
					</div>

					
					<div class="btn-toolbar" role="toolbar" >
						
							<button class="btn btn-md btn-warning pull-right"  ng-disabled="queryForm.$invalid" ng-click="runQuery()">
				   				<span class="glyphicon glyphicon-play"></span > Run Query
				   			</button>
					</div>	
					
          	 		
 				</div> <!-- end of panel body -->
			</div> <!--  end of panel -->
     	</div> <!--  end of sidebar  -->
     	
     	
     	<!--                 -->
        <!--  Results Panel  -->
     	<!--                 -->
		<div class="col-sm-12 col-md-12 col-lg-8" >
			
			<div class=" panel panel-default">
			
				<div class="panel-heading" >
				   	Results
				  
			   	  <button class="btn btn-sm btn-info pull-right" ng-show="hasResults" style="margin-top: -6px; margin-left: 10px"><span class="glyphicon glyphicon-eye-open"></span> Display in IGV</button>
			   	  <button class="btn btn-sm btn-info pull-right" ng-show="hasResults" style="margin-top: -6px; margin-left: 10px"><span class="glyphicon glyphicon-download"></span> Download</button>
			   	  <button class="btn btn-sm btn-danger pull-right" ng-show="warnings != ''" ng-click="displayWarnings()" style="margin-top: -6px; margin-left: 10px"><span class="glyphicon glyphicon-exclamation-sign"></span></button>
				</div>
				
				<div class="panel-body">
				
				<!-- The query summary -->
				<div class="row" style="margin-top: 0px; margin-bottom: 10px;">
					<div class="col-md-12">
			   	       	<span class="well-querysum" ng-repeat="row in querySummary">{{ row }}</span> 
					</div>
				</div>	

			    <table class="table table-striped table-hover" style="width: 100%;" ng-show="hasResults">
			    	<colgroup>
				        <col width="0%" />
				        <col width="20%" />
				        <col width="25%" />
				        <col width="0%" />
				        <col width="25%" />
				        <col width="25%" />
				        <col width="0%" />
				        <col width="0%" />
				        <col width="0%" />
				    </colgroup>
			        <thead>
			            <tr>
			                <th></th>
							<th>Project</th>
							<th>Analysis</th>
							<th>Type</th>
							<th>Summary</th>
							<th>Conditions</th>
							<th>Coordinates</th>
							<th>FDR</th>
							<th>Log2Ratio</th>
			            </tr>
			        </thead>
			        <tbody>
			            <tr ng-repeat="row in queryResults">
			            	<td><input type="checkbox"/></td>
			            	
			                <td class="nowrap-ellipsis" ><span tooltip="{{row.projectName}}">{{row.projectName}}</td>
			                <td class="nowrap-ellipsis"><span tooltip="{{row.analysisName}}">{{row.analysisName}}</span></td>
			                <td class="nowrap">{{row.analysisType}}</td>
			                <td class="nowrap-ellipsis"><span tooltip="{{row.analysisDescription}}">{{row.analysisSummary}}</span></td>
			                <td class="nowrap-ellipsis"><span tooltip="{{row.sampleConditions}}">{{row.sampleConditions}}</td>
			                <td class="nowrap">{{row.coordinates}}</td>
			                <td class="nowrap">{{row.fdr}}</td>
			                <td class="nowrap">{{row.log2Ratio}}</td>
			            </tr>
			
			        </tbody>
			
			    </table>

				
				
			</div>
		
		</div> 
		
	</div>  <!-- end of row (main panel) -->

</fieldset>
</form>

